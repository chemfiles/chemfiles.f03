<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Fortran interface reference &#8212; Fortran interface to chemfiles 0.7.4
 documentation</title>
    
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.7.4',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-3.3.6/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Usage examples" href="examples.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head>
  <body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="index.html">
          Fortran interface to chemfiles</a>
        <span class="navbar-text navbar-version pull-left"><b>0.7</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples.html">Usage examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Fortran interface reference</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Fortran interface reference</a><ul>
<li><a class="reference internal" href="#conventions">Conventions</a></li>
<li><a class="reference internal" href="#error-and-logging-functions">Error and logging functions</a></li>
<li><a class="reference internal" href="#chfl-trajectory-type"><code class="docutils literal"><span class="pre">chfl_trajectory</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-frame-type"><code class="docutils literal"><span class="pre">chfl_frame</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-cell-type"><code class="docutils literal"><span class="pre">chfl_cell</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-topology-type"><code class="docutils literal"><span class="pre">chfl_topology</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-residue-type"><code class="docutils literal"><span class="pre">chfl_residue</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-atom-type"><code class="docutils literal"><span class="pre">chfl_atom</span></code> type</a></li>
<li><a class="reference internal" href="#chfl-selection-type"><code class="docutils literal"><span class="pre">chfl_selection</span></code> type</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="examples.html" title="Previous Chapter: Usage examples"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; Usage examples</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="_sources/reference.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="col-md-12 content">
      
  <div class="section" id="fortran-interface-reference">
<span id="fortran-api"></span><h1>Fortran interface reference<a class="headerlink" href="#fortran-interface-reference" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal"><span class="pre">chemfiles</span></code> module is built around the main types of chemfiles:
<a class="reference internal" href="#f%_%chfl_trajectory" title="f%_%chfl_trajectory"><code class="xref f f-type docutils literal"><span class="pre">chfl_trajectory</span></code></a>, <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a>, <a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><code class="xref f f-type docutils literal"><span class="pre">chfl_cell</span></code></a>,
<a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><code class="xref f f-type docutils literal"><span class="pre">chfl_topology</span></code></a>, <a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><code class="xref f f-type docutils literal"><span class="pre">chfl_residue</span></code></a>, <a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><code class="xref f f-type docutils literal"><span class="pre">chfl_atom</span></code></a> and
<a class="reference internal" href="#f%_%chfl_selection" title="f%_%chfl_selection"><code class="xref f f-type docutils literal"><span class="pre">chfl_selection</span></code></a>. For more information about these types, please see the
chemfiles <a class="reference external" href="http://chemfiles.org/chemfiles/latest/overview.html">overview</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Atomic indexes in chemfiles starts at 0, not 1. That means that the first
atom in a frame have the index 0, not 1. This should be taken in account
when using chemfiles functions. Fortran arrays returned by function still
have indexes starting at 1.</p>
<div class="last highlight-fortran"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">indexing</span>
    <span class="k">use </span><span class="n">iso_fortran_env</span><span class="p">,</span> <span class="n">only</span><span class="p">:</span> <span class="n">real64</span><span class="p">,</span> <span class="n">int64</span>
    <span class="k">use </span><span class="n">chemfiles</span>
    <span class="k">implicit none</span>
<span class="k">    type</span><span class="p">(</span><span class="n">chfl_frame</span><span class="p">)</span>      <span class="kd">::</span> <span class="n">frame</span>
    <span class="k">type</span><span class="p">(</span><span class="n">chfl_atom</span><span class="p">)</span>       <span class="kd">::</span> <span class="n">atom</span>
    <span class="kt">real</span><span class="p">(</span><span class="n">real64</span><span class="p">),</span> <span class="k">pointer</span> <span class="kd">::</span> <span class="n">positions</span><span class="p">(:,</span> <span class="p">:)</span>
    <span class="kt">integer</span><span class="p">(</span><span class="n">int64</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">natoms</span>

    <span class="c">! Initialize the frame ...</span>

    <span class="c">! Get the first atom in the frame</span>
    <span class="k">call </span><span class="n">atom</span><span class="p">%</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="c">! Get the second atom in the frame</span>
    <span class="k">call </span><span class="n">atom</span><span class="p">%</span><span class="n">from_frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">call </span><span class="n">frame</span><span class="p">%</span><span class="n">poositions</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">natoms</span><span class="p">)</span>
    <span class="c">! position(1, :) now contains the positions of the first atom</span>
<span class="k">end program</span>
</pre></div>
</div>
</div>
<div class="section" id="conventions">
<h2>Conventions<a class="headerlink" href="#conventions" title="Permalink to this headline">¶</a></h2>
<p>All the functions and types have the <code class="docutils literal"><span class="pre">chfl_</span></code> prefix. All the functions take an
optional <code class="docutils literal"><span class="pre">status</span></code> argument which will indicate the status of the operation. It
should be <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code> if everything was OK, and another value indicating in
case of error. The only exeption to this rule are the functions returnning
character strings: <code class="docutils literal"><span class="pre">chfl_version</span></code> and <code class="docutils literal"><span class="pre">chfl_last_error()</span></code>.</p>
<p>When creating a variable of one of the chemfiles types, the first routine to be
called should be an initialization routine. It can be either the <code class="docutils literal"><span class="pre">init</span></code>
routine for default initialization, or another routine documented as
initializing.</p>
<div class="highlight-fortran"><div class="highlight"><pre><span></span><span class="k">type</span><span class="p">(</span><span class="n">chfl_cell</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cell</span>
<span class="k">type</span><span class="p">(</span><span class="n">chfl_frame</span><span class="p">)</span> <span class="kd">::</span> <span class="n">frame</span>

<span class="c">! Initialize the variables</span>
<span class="k">call </span><span class="n">cell</span><span class="p">%</span><span class="n">init</span><span class="p">([</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">])</span>
<span class="k">call </span><span class="n">frame</span><span class="p">%</span><span class="n">init</span><span class="p">()</span>

<span class="c">! free the memory</span>
<span class="k">call </span><span class="n">cell</span><span class="p">%</span><span class="n">free</span><span class="p">()</span>
<span class="k">call </span><span class="n">frame</span><span class="p">%</span><span class="n">free</span><span class="p">()</span>
</pre></div>
</div>
<p>These initialization function should only be called once. In order to free the
memory asssociated with any chemfiles variable, the <code class="docutils literal"><span class="pre">free</span></code> subroutine should
be called. After a call the the <code class="docutils literal"><span class="pre">free</span></code> subroutine, the <code class="docutils literal"><span class="pre">init</span></code> subroutine can
be called again whithout any memory leak risk. Not initializing chemfiles
variables will lead to errors.</p>
</div>
<div class="section" id="error-and-logging-functions">
<h2>Error and logging functions<a class="headerlink" href="#error-and-logging-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="f%_%chfl_version">
<em class="property">function  </em><code class="descname">chfl_version</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f%_%chfl_version" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the version of the Chemfiles library.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><strong>character</strong><em> [</em><em>len=*</em><em>]</em> :: chemfiles version</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="f%_%chfl_last_error">
<em class="property">function  </em><code class="descname">chfl_last_error</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#f%_%chfl_last_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the last error message emmited by Chemfiles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Return:</th><td class="field-body"><strong>character</strong><em> [</em><em>len=*</em><em>]</em> :: error message for the last error</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%_%chfl_clear_errors">
<em class="property">subroutine  </em><code class="descname">chfl_clear_errors</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%_%chfl_clear_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the last error message emmited by Chemfiles.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%_%chfl_set_warning_callback">
<em class="property">subroutine  </em><code class="descname">chfl_set_warning_callback</code><span class="sig-paren">(</span><em>callback</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%_%chfl_set_warning_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Chemfiles sends warning on various events, for example invalid files or
errors in the API usage. By default they are printed to the standard error
stream, but you can redirect them by setting a callback to be called on each
event with the event message. This function set the callback for all warning
events.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>callback</strong><em> [</em><em>procedure</em><em>,</em><em>kind=chfl_warning_callback</em><em>]</em> :: warning callback</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%_%chfl_warning_callback">
<em class="property">subroutine  </em><code class="descname">chfl_warning_callback</code><span class="sig-paren">(</span><em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#f%_%chfl_warning_callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Interface for the warning callback to be used with
<code class="docutils literal"><span class="pre">chfl_set_warning_callback</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>message</strong><em> [</em><em>character</em><em>,</em><em>len=*, intent(in)</em><em>]</em> :: The warning message</td>
</tr>
</tbody>
</table>
</dd></dl>

<p>The optional status argument is an integer of kind <code class="docutils literal"><span class="pre">chfl_status</span></code>, which can
take the following values:</p>
<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_SUCCESS</code></dt>
<dd><p>Status for successful operations.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_MEMORY_ERROR</code></dt>
<dd><p>Status code for error concerning memory: out of memory, wrong size for
pre-allocated buffers, <em>etc.</em></p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_FILE_ERROR</code></dt>
<dd><p>Status code for error concerning files: the file do not exist, the user
does not have rights to open it, <em>etc.</em></p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_FORMAT_ERROR</code></dt>
<dd><p>Status code for error in file formating, i.e. for invalid files.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_SELECTION_ERROR</code></dt>
<dd><p>Status code for invalid selection strings.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_GENERIC_ERROR</code></dt>
<dd><p>Status code for any other error from Chemfiles.</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_status) :: CHFL_CXX_ERROR</code></dt>
<dd><p>Status code for error in the C++ standard library.</p>
</dd></dl>

</div>
<div class="section" id="chfl-trajectory-type">
<h2><code class="docutils literal"><span class="pre">chfl_trajectory</span></code> type<a class="headerlink" href="#chfl-trajectory-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_trajectory">
<em class="property">type  </em><code class="descname">chfl_trajectory</code><a class="headerlink" href="#f%_%chfl_trajectory" title="Permalink to this definition">¶</a></dt>
<dd><p>The <a class="reference internal" href="#f%_%chfl_trajectory" title="f%_%chfl_trajectory"><code class="xref f f-type docutils literal"><span class="pre">chfl_trajectory</span></code></a> type is the main entry point when using
chemfiles. A <a class="reference internal" href="#f%_%chfl_trajectory" title="f%_%chfl_trajectory"><code class="xref f f-type docutils literal"><span class="pre">chfl_trajectory</span></code></a> behave a like a file, allowing to
read and/or write <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a>.</p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_trajectory" title="f%_%chfl_trajectory"><code class="xref f f-type docutils literal"><span class="pre">chfl_trajectory</span></code></a> are
<a class="reference internal" href="#f%chfl_trajectory%open" title="f%chfl_trajectory%open"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%open()</span></code></a> and <a class="reference internal" href="#f%chfl_trajectory%with_format" title="f%chfl_trajectory%with_format"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%with_format()</span></code></a>.
The memory liberation routine is <a class="reference internal" href="#f%chfl_trajectory%close" title="f%chfl_trajectory%close"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%close()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">open</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%open" title="f%chfl_trajectory%open"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%open()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">with_format</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%with_format" title="f%chfl_trajectory%with_format"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%with_format()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">nsteps</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%nsteps" title="f%chfl_trajectory%nsteps"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%nsteps()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">read</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%read" title="f%chfl_trajectory%read"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%read()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">read_step</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%read_step" title="f%chfl_trajectory%read_step"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%read_step()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">write</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%write" title="f%chfl_trajectory%write"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%write()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_topology</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%set_topology" title="f%chfl_trajectory%set_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%set_topology()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">topology_file</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%topology_file" title="f%chfl_trajectory%topology_file"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%topology_file()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_cell</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%set_cell" title="f%chfl_trajectory%set_cell"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%set_cell()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">close</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_trajectory%close" title="f%chfl_trajectory%close"><code class="xref f f-func docutils literal"><span class="pre">chfl_trajectory%close()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%open">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">open</code><span class="sig-paren">(</span><em>path</em>, <em>mode</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%open" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the file at the given <code class="docutils literal"><span class="pre">path</span></code> using the given <code class="docutils literal"><span class="pre">mode</span></code>.
Valid modes are <code class="docutils literal"><span class="pre">'r'</span></code> for read, <code class="docutils literal"><span class="pre">'w'</span></code> for write and <code class="docutils literal"><span class="pre">'a'</span></code> for append.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: path to the trajectory file</li>
<li><strong>mode</strong><em> [</em><em>character</em><em>]</em> :: opening mode</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%with_format">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">with_format</code><span class="sig-paren">(</span><em>path</em>, <em>mode</em>, <em>format</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%with_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Open the trajectory at the given <code class="docutils literal"><span class="pre">path</span></code> using a specific file <code class="docutils literal"><span class="pre">format</span></code>
and the given <code class="docutils literal"><span class="pre">mode</span></code>.</p>
<p>This is be needed when the file format does not match the extension, or when
there is not standard extension for this format. Valid modes are <code class="docutils literal"><span class="pre">'r'</span></code> for
read, <code class="docutils literal"><span class="pre">'w'</span></code> for write and <code class="docutils literal"><span class="pre">'a'</span></code> for append.</p>
<p>If <code class="docutils literal"><span class="pre">format</span></code> is an empty string, the format will be guessed from the
extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>path</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: path to the trajectory file</li>
<li><strong>mode</strong><em> [</em><em>character</em><em>]</em> :: opening mode</li>
<li><strong>format</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: format to use</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%read">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">read</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the next step of the trajectory into a <code class="docutils literal"><span class="pre">frame</span></code>.</p>
<p>If the number of atoms in frame does not correspond to the number of atom in
the next step, the frame is resized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame to fill with the data</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%read_step">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">read_step</code><span class="sig-paren">(</span><em>step</em>, <em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%read_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a specific <code class="docutils literal"><span class="pre">step</span></code> of the trajectory into a <code class="docutils literal"><span class="pre">frame</span></code>. The first
trajectory step is the step 0.</p>
<p>If the number of atoms in frame does not correspond to the number of atom
in the step, the frame is resized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: step to read</li>
<li><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame to fill with the data</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%write">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">write</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a single <code class="docutils literal"><span class="pre">frame</span></code> to the trajectory.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame to be writen to the file</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%set_topology">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">set_topology</code><span class="sig-paren">(</span><em>topology</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%set_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <code class="docutils literal"><span class="pre">topology</span></code> associated with the trajectory. This topology will be
used when reading and writing the files, replacing any topology in the
frames or files.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: new topology to use</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%topology_file">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">topology_file</code><span class="sig-paren">(</span><em>path</em><span class="optional">[</span>, <em>format</em>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%topology_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the topology associated with the trajectory by reading the first frame of
the file at the given <code class="docutils literal"><span class="pre">path</span></code> using the file format in <code class="docutils literal"><span class="pre">format</span></code>; and
extracting the topology of this frame.</p>
<p>If <code class="docutils literal"><span class="pre">format</span></code> is an empty string or not given, the format will be guessed
from the extension.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>path</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: file to read in order to get the new topology</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><ul class="first last simple">
<li><strong>format</strong><em> [</em><em>string</em><em>,</em><em>optional</em><em>]</em> :: format to use for the topology file</li>
<li><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%set_cell">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">set_cell</code><span class="sig-paren">(</span><em>cell</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%set_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the unit <code class="docutils literal"><span class="pre">cell</span></code> associated with the trajectory. This cell will be used
when reading and writing the files, replacing any pre-existing unit cell.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell</strong><em> [</em><a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><em>chfl_cell</em></a><em>]</em> :: new cell to use</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%nsteps">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">nsteps</code><span class="sig-paren">(</span><em>nsteps</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%nsteps" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the number of steps (the number of frames) from the trajectory in
<code class="docutils literal"><span class="pre">nsteps</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nsteps</strong><em> [</em><em>integer</em><em>]</em> :: number of steps</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_trajectory%close">
<em class="property">subroutine  </em><code class="descclassname">chfl_trajectory%</code><code class="descname">close</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_trajectory%close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close a trajectory file, and free the associated memory.</p>
<p>Closing a file will synchronize all changes made to the file with the
storage (hard drive, network, …) used for this file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-frame-type">
<h2><code class="docutils literal"><span class="pre">chfl_frame</span></code> type<a class="headerlink" href="#chfl-frame-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_frame">
<em class="property">type  </em><code class="descname">chfl_frame</code><a class="headerlink" href="#f%_%chfl_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a> contains data from one simulation step: the current unit
cell, the topology, the positions, and the velocities of the particles in
the system. If some information is missing (topology or velocity or unit
cell), the corresponding data is filled with a default value.</p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a> are
<a class="reference internal" href="#f%chfl_frame%init" title="f%chfl_frame%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%init()</span></code></a> and <a class="reference internal" href="#f%chfl_frame%copy" title="f%chfl_frame%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%copy()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%init" title="f%chfl_frame%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%copy" title="f%chfl_frame%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">atoms_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%atoms_count" title="f%chfl_frame%atoms_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%atoms_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_atom</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%add_atom" title="f%chfl_frame%add_atom"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%add_atom()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">remove</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%remove" title="f%chfl_frame%remove"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%remove()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">resize</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%resize" title="f%chfl_frame%resize"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%resize()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">positions</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%positions" title="f%chfl_frame%positions"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%positions()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">velocities</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%velocities" title="f%chfl_frame%velocities"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%velocities()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_velocities</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%add_velocities" title="f%chfl_frame%add_velocities"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%add_velocities()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">has_velocities</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%has_velocities" title="f%chfl_frame%has_velocities"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%has_velocities()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_cell</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%set_cell" title="f%chfl_frame%set_cell"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%set_cell()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_topology</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%set_topology" title="f%chfl_frame%set_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%set_topology()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">guess_topology</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%guess_topology" title="f%chfl_frame%guess_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%guess_topology()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">step</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%step" title="f%chfl_frame%step"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%step()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_step</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%set_step" title="f%chfl_frame%set_step"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%set_step()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_frame%free" title="f%chfl_frame%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">init</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this unit cell with a new empty frame. It will be resized by the
library as needed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this frame with a copy of <code class="docutils literal"><span class="pre">frame</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%atoms_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">atoms_count</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%atoms_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current number of atoms in the frame in <code class="docutils literal"><span class="pre">natoms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: number of atoms in the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%add_atom">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">add_atom</code><span class="sig-paren">(</span><em>atom</em>, <em>position</em><span class="optional">[</span>, <em>velocity</em>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a <a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><code class="xref f f-type docutils literal"><span class="pre">chfl_atom</span></code></a> and the corresponding <code class="docutils literal"><span class="pre">position</span></code> and
<code class="docutils literal"><span class="pre">velocity</span></code> data to this frame. <code class="docutils literal"><span class="pre">velocity</span></code> can be absent if no velocity
is associated with this frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atom</strong><em> [</em><a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><em>chfl_atom</em></a><em>]</em> :: atom to add to the frame</li>
<li><strong>position</strong> (3)<em> [</em><em>real</em><em>]</em> :: atom position</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><ul class="first last simple">
<li><strong>velocity</strong> (3)<em> [</em><em>real</em><em>,</em><em>optional</em><em>]</em> :: atom velocity</li>
<li><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%remove">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">remove</code><span class="sig-paren">(</span><em>index</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the atom at the given <code class="docutils literal"><span class="pre">index</span></code> in the frame.</p>
<p>This modify all the atoms indexes after <code class="docutils literal"><span class="pre">index</span></code>, and invalidate any
pointer obtained using <a class="reference internal" href="#f%chfl_frame%positions" title="f%chfl_frame%positions"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%positions()</span></code></a> or
<a class="reference internal" href="#f%chfl_frame%velocities" title="f%chfl_frame%velocities"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%velocities()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>index</strong><em> [</em><em>integer</em><em>]</em> :: index of the atom to remove</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%resize">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">resize</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize the positions, velocities and topology in the frame, to have space
for <code class="docutils literal"><span class="pre">natoms</span></code> atoms.</p>
<p>This function may invalidate any pointer to the positions or the velocities
if the new size is bigger than the old one. In all the cases, previous data
is conserved. This function conserve the presence or absence of velocities.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: the new number of atoms in the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%positions">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">positions</code><span class="sig-paren">(</span><em>data</em>, <em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a pointer to the positions array from the frame.</p>
<p>This function set the <code class="docutils literal"><span class="pre">data</span></code> array to be the internal positions array.
This array is a <code class="docutils literal"><span class="pre">natoms</span> <span class="pre">x</span> <span class="pre">3</span></code> array, and the number of atoms will be in the
<code class="docutils literal"><span class="pre">size</span></code> parameter.</p>
<p>This function gives access to chemfiles internal data structure, and do not
perform any copy, both when reading and writing the positions.</p>
<p>If the frame is resized (by writing to it, or calling
<a class="reference internal" href="#f%chfl_frame%resize" title="f%chfl_frame%resize"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%resize()</span></code></a>), the pointer is invalidated. If the frame is
freed using <a class="reference internal" href="#f%chfl_frame%free" title="f%chfl_frame%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%free()</span></code></a>, the pointer is freed too.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (*, *)<em> [</em><em>real</em><em>,</em><em>pointer</em><em>]</em> :: pointer to a float array containing
the positions</li>
<li><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: number of atom, <em>i.e.</em> size of the <code class="docutils literal"><span class="pre">data</span></code> array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%velocities">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">velocities</code><span class="sig-paren">(</span><em>data</em>, <em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a pointer to the velocities array from the frame.</p>
<p>This function set the <code class="docutils literal"><span class="pre">data</span></code> array to be the internal positions array.
This array is a <code class="docutils literal"><span class="pre">natoms</span> <span class="pre">x</span> <span class="pre">3</span></code> array, and the number of atoms will be in the
<code class="docutils literal"><span class="pre">size</span></code> parameter.</p>
<p>This function gives access to chemfiles internal data structure, and do not
perform any copy, both when reading and writing the velocities.</p>
<p>If the frame is resized (by writing to it, or calling
<a class="reference internal" href="#f%chfl_frame%resize" title="f%chfl_frame%resize"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%resize()</span></code></a>), the pointer is invalidated. If the frame is
freed using <a class="reference internal" href="#f%chfl_frame%free" title="f%chfl_frame%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_frame%free()</span></code></a>, the pointer is freed too.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (*, *)<em> [</em><em>real</em><em>,</em><em>pointer</em><em>]</em> :: pointer to a float array containing
the velocities</li>
<li><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: number of atom, <em>i.e.</em> size of the <code class="docutils literal"><span class="pre">data</span></code> array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%add_velocities">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">add_velocities</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%add_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Add velocity data to this frame.</p>
<p>The velocities ar initialized to zero. If the frame already has velocities,
this does nothing.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%has_velocities">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">has_velocities</code><span class="sig-paren">(</span><em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%has_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if this frame contains velocity data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>result</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the frame has velocities,
<code class="docutils literal"><span class="pre">.false.</span></code> otherwise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%set_cell">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">set_cell</code><span class="sig-paren">(</span><em>cell</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%set_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><code class="xref f f-type docutils literal"><span class="pre">chfl_cell</span></code></a> of this frame to <code class="docutils literal"><span class="pre">cell</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell</strong><em> [</em><a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><em>chfl_cell</em></a><em>]</em> :: new unit cell of the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%set_topology">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">set_topology</code><span class="sig-paren">(</span><em>topology</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%set_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the <a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><code class="xref f f-type docutils literal"><span class="pre">chfl_topology</span></code></a> of this frame to <code class="docutils literal"><span class="pre">topology</span></code>.</p>
<p>Calling this function with a topology that does not contain the right number
of atom will return an error.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: new topology of the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%step">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">step</code><span class="sig-paren">(</span><em>step</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%step" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the frame step, <em>i.e.</em> the frame number in the trajectory in <code class="docutils literal"><span class="pre">step</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: frame step number</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%set_step">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">set_step</code><span class="sig-paren">(</span><em>step</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%set_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the frame step, <em>i.e.</em> the frame number in the trajectory to <code class="docutils literal"><span class="pre">step</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>step</strong><em> [</em><em>integer</em><em>]</em> :: The new frame step</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%guess_topology">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">guess_topology</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%guess_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Guess the bonds, angles and dihedrals in the frame.</p>
<p>The bonds are guessed using a distance-based algorithm, and then angles and
dihedrals are guessed from the bonds.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_frame%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_frame%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_frame%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy a frame, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-cell-type">
<h2><code class="docutils literal"><span class="pre">chfl_cell</span></code> type<a class="headerlink" href="#chfl-cell-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_cell">
<em class="property">type  </em><code class="descname">chfl_cell</code><a class="headerlink" href="#f%_%chfl_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><code class="xref f f-type docutils literal"><span class="pre">chfl_cell</span></code></a> represent the box containing the atoms, and its
periodicity.</p>
<p>An unit cell is fully represented by three lengths (a, b, c); and three
angles (alpha, beta, gamma). The angles are stored in degrees, and the
lengths in Angstroms.</p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><code class="xref f f-type docutils literal"><span class="pre">chfl_cell</span></code></a> are
<a class="reference internal" href="#f%chfl_cell%init" title="f%chfl_cell%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%init()</span></code></a>, <a class="reference internal" href="#f%chfl_cell%triclinic" title="f%chfl_cell%triclinic"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%triclinic()</span></code></a>,
<a class="reference internal" href="#f%chfl_cell%from_frame" title="f%chfl_cell%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%from_frame()</span></code></a> and <a class="reference internal" href="#f%chfl_cell%copy" title="f%chfl_cell%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%copy()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%init" title="f%chfl_cell%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">triclinic</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%triclinic" title="f%chfl_cell%triclinic"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%triclinic()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%from_frame" title="f%chfl_cell%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%from_frame()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%copy" title="f%chfl_cell%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">lengths</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%lengths" title="f%chfl_cell%lengths"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%lengths()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_lengths</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%set_lengths" title="f%chfl_cell%set_lengths"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%set_lengths()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">angles</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%angles" title="f%chfl_cell%angles"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%angles()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_angles</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%set_angles" title="f%chfl_cell%set_angles"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%set_angles()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">matrix</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%matrix" title="f%chfl_cell%matrix"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%matrix()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">shape</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%shape" title="f%chfl_cell%shape"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%shape()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_shape</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%set_shape" title="f%chfl_cell%set_shape"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%set_shape()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">volume</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%volume" title="f%chfl_cell%volume"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%volume()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_cell%free" title="f%chfl_cell%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_cell%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">init</code><span class="sig-paren">(</span><em>lengths</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this unit cell with an unit cell having the given <code class="docutils literal"><span class="pre">lengths</span></code>.
The unit cell shape is <code class="xref f f-var docutils literal"><span class="pre">CHFL_CELL_ORTHORHOMBIC</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lengths</strong> (3)<em> [</em><em>real</em><em>]</em> :: cell lengths, in angstroms</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%triclinic">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">triclinic</code><span class="sig-paren">(</span><em>lengths</em>, <em>angles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%triclinic" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this unit cell with an unit cell having the given <code class="docutils literal"><span class="pre">lengths</span></code> and
<code class="docutils literal"><span class="pre">angles</span></code>. The unit cell shape is <code class="xref f f-var docutils literal"><span class="pre">CHFL_CELL_TRICLINIC</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>lengths</strong> (3)<em> [</em><em>real</em><em>]</em> :: cell lengths, in angstroms</li>
<li><strong>angles</strong> (3)<em> [</em><em>real</em><em>]</em> :: cell angles, in degrees</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>cell</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this unit cell with a copy of <code class="docutils literal"><span class="pre">cell</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>cell</strong><em> [</em><a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><em>chfl_cell</em></a><em>]</em> :: cell to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%from_frame">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">from_frame</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this topology with a copy of the <a class="reference internal" href="#f%_%chfl_cell" title="f%_%chfl_cell"><code class="xref f f-type docutils literal"><span class="pre">chfl_cell</span></code></a> of a frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%volume">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">volume</code><span class="sig-paren">(</span><em>volume</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%volume" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the volume of the unit cell in <code class="docutils literal"><span class="pre">volume</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>volume</strong><em> [</em><em>real</em><em>]</em> :: volume of the unit cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%lengths">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">lengths</code><span class="sig-paren">(</span><em>lengths</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit cell lengths in <code class="docutils literal"><span class="pre">lengths</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lengths</strong> (3)<em> [</em><em>real</em><em>]</em> :: cell lengths, in angstroms</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%set_lengths">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">set_lengths</code><span class="sig-paren">(</span><em>lengths</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%set_lengths" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the unit cell lengths to <code class="docutils literal"><span class="pre">lengths</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>lengths</strong> (3)<em> [</em><em>real</em><em>]</em> :: new cell lengths, in angstroms</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%angles">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">angles</code><span class="sig-paren">(</span><em>angles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit cell angles in <code class="docutils literal"><span class="pre">angles</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>angles</strong> (3)<em> [</em><em>real</em><em>]</em> :: cell angles, in degrees</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%set_angles">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">set_angles</code><span class="sig-paren">(</span><em>alpha</em>, <em>beta</em>, <em>gamma</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%set_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the cell angles to <code class="docutils literal"><span class="pre">angles</span></code>. Trying to set cell angles on a cell which
is not triclinic (does not have the <code class="docutils literal"><span class="pre">CHFL_CELL_TRICLINIC</span></code> shape) is an
error.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>angles</strong> (3)<em> [</em><em>real</em><em>]</em> :: new cell angles, in degrees</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%matrix">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">matrix</code><span class="sig-paren">(</span><em>matrix</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit cell matricial representation in <code class="docutils literal"><span class="pre">matrix</span></code>.</p>
<p>The unit cell representation is obtained by aligning the a vector along the
<em>x</em> axis and putting the b vector in the <em>xy</em> plane. This make the matrix
an upper triangular matrix:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="p">|</span> a_x b_x c_x <span class="p">|</span>
<span class="p">|</span>  <span class="m">0</span>  b_y c_y <span class="p">|</span>
<span class="p">|</span>  <span class="m">0</span>   <span class="m">0</span>  c_z <span class="p">|</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>matrix</strong> (3, 3)<em> [</em><em>real</em><em>]</em> :: unit cell matrix</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%shape">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">shape</code><span class="sig-paren">(</span><em>shape</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit cell shape in <code class="docutils literal"><span class="pre">shape</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=chfl_cell_shape_t</em><em>]</em> :: the shape of the cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
<p>The cell shapes are integers which <code class="docutils literal"><span class="pre">kind</span></code> is the <code class="docutils literal"><span class="pre">chfl_cell_shape_t</span></code>
parameter:</p>
<dl class="variable">
<dt>
<code class="descname">integer(chfl_cell_shape_t) :: CHFL_CELL_ORTHORHOMBIC</code></dt>
<dd><p>The three angles are 90°</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_cell_shape_t) :: CHFL_CELL_TRICLINIC</code></dt>
<dd><p>The three angles may not be 90°</p>
</dd></dl>

<dl class="variable">
<dt>
<code class="descname">integer(chfl_cell_shape_t) :: CHFL_CELL_INFINITE</code></dt>
<dd><p>Cell type when there is no periodic boundary conditions</p>
</dd></dl>

</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%set_shape">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">set_shape</code><span class="sig-paren">(</span><em>shape</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%set_shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the unit cell shape to <code class="docutils literal"><span class="pre">shape</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>type</strong><em> [</em><em>integer</em><em>,</em><em>kind=chfl_cell_shape_t</em><em>]</em> :: the new type of the cell</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_cell%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_cell%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_cell%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy an unit cell, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-topology-type">
<h2><code class="docutils literal"><span class="pre">chfl_topology</span></code> type<a class="headerlink" href="#chfl-topology-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_topology">
<em class="property">type  </em><code class="descname">chfl_topology</code><a class="headerlink" href="#f%_%chfl_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><code class="xref f f-type docutils literal"><span class="pre">chfl_topology</span></code></a> contains the definition of all the atoms in the
system, and the liaisons between the atoms (bonds, angles, dihedrals,
…). It will also contain all the residues information if it is available.</p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><code class="xref f f-type docutils literal"><span class="pre">chfl_topology</span></code></a> are
<a class="reference internal" href="#f%chfl_topology%init" title="f%chfl_topology%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%init()</span></code></a>, <a class="reference internal" href="#f%chfl_topology%from_frame" title="f%chfl_topology%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%from_frame()</span></code></a> and
<a class="reference internal" href="#f%chfl_topology%copy" title="f%chfl_topology%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%copy()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%init" title="f%chfl_topology%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%copy" title="f%chfl_topology%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%from_frame" title="f%chfl_topology%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%from_frame()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">atoms_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%atoms_count" title="f%chfl_topology%atoms_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%atoms_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_atom</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%add_atom" title="f%chfl_topology%add_atom"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%add_atom()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">resize</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%resize" title="f%chfl_topology%resize"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%resize()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">remove</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%remove" title="f%chfl_topology%remove"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%remove()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_bond</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%add_bond" title="f%chfl_topology%add_bond"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%add_bond()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">remove_bond</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%remove_bond" title="f%chfl_topology%remove_bond"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%remove_bond()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">isbond</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%isbond" title="f%chfl_topology%isbond"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%isbond()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">isangle</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%isangle" title="f%chfl_topology%isangle"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%isangle()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">isdihedral</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%isdihedral" title="f%chfl_topology%isdihedral"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%isdihedral()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">bonds_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%bonds_count" title="f%chfl_topology%bonds_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%bonds_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">angles_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%angles_count" title="f%chfl_topology%angles_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%angles_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">dihedrals_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%dihedrals_count" title="f%chfl_topology%dihedrals_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%dihedrals_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">bonds</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%bonds" title="f%chfl_topology%bonds"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%bonds()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">angles</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%angles" title="f%chfl_topology%angles"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%angles()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">dihedrals</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%dihedrals" title="f%chfl_topology%dihedrals"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%dihedrals()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">residues_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%residues_count" title="f%chfl_topology%residues_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%residues_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_residue</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%add_residue" title="f%chfl_topology%add_residue"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%add_residue()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">residues_linked</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%residues_linked" title="f%chfl_topology%residues_linked"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%residues_linked()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_topology%free" title="f%chfl_topology%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">init</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this topology with a new empty topology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%from_frame">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">from_frame</code><span class="sig-paren">(</span><em>frame</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this topology with a copy of the topology of <code class="docutils literal"><span class="pre">frame</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: the frame</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>topology</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this topology with a copy of <code class="docutils literal"><span class="pre">topology</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: topology to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%atoms_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">atoms_count</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%atoms_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of atoms in the topology in <code class="docutils literal"><span class="pre">natoms</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: number of atoms in the topology</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%resize">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">resize</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%resize" title="Permalink to this definition">¶</a></dt>
<dd><p>Resize the topology to hold <code class="docutils literal"><span class="pre">natoms</span></code> atoms. If the new number of atoms is
bigger than the current number, new atoms will be created with an empty name
and type. If it is lower than the current number of atoms, the last atoms
will be removed, together with the associated bonds, angles and dihedrals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: new size of the topology</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%add_atom">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">add_atom</code><span class="sig-paren">(</span><em>atom</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a copy of <code class="docutils literal"><span class="pre">atom</span></code> at the end of the topology.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong><em> [</em><a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><em>chfl_atom</em></a><em>]</em> :: atom to be added</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%remove">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">remove</code><span class="sig-paren">(</span><em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%remove" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove the atom at index <code class="docutils literal"><span class="pre">i</span></code> from the topology.</p>
<p>This shifts all the atoms indexes after <code class="docutils literal"><span class="pre">i</span></code> by 1 (n becomes n-1).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: index of the atom to remove</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%isbond">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">isbond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%isbond" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the atoms at indexes <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> are bonded together, and store
the result in <code class="docutils literal"><span class="pre">result</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the second atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms are bonded,
<code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%isangle">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">isangle</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%isangle" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the atoms at indexes <code class="docutils literal"><span class="pre">i</span></code>, <code class="docutils literal"><span class="pre">j</span></code> and <code class="docutils literal"><span class="pre">k</span></code> form an angle, and
store the result in <code class="docutils literal"><span class="pre">result</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the second atom</li>
<li><strong>k</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the third atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms form an angle,
<code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%isdihedral">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">isdihedral</code><span class="sig-paren">(</span><em>i</em>, <em>j</em>, <em>k</em>, <em>m</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%isdihedral" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the atoms at indexes <code class="docutils literal"><span class="pre">i</span></code>, <code class="docutils literal"><span class="pre">j</span></code>, <code class="docutils literal"><span class="pre">k</span></code> and <code class="docutils literal"><span class="pre">m</span></code> form a dihedral
angle, and store the result in <code class="docutils literal"><span class="pre">result</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the second atom</li>
<li><strong>k</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the third atom</li>
<li><strong>m</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the fourth atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the atoms form a dihedral
angle, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%bonds_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">bonds_count</code><span class="sig-paren">(</span><em>nbonds</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%bonds_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of bonds in the topology in <code class="docutils literal"><span class="pre">nbonds</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nbonds</strong><em> [</em><em>integer</em><em>]</em> :: number of bonds</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%angles_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">angles_count</code><span class="sig-paren">(</span><em>nangles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%angles_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of angles in the topology in <code class="docutils literal"><span class="pre">nangles</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nangles</strong><em> [</em><em>integer</em><em>]</em> :: number of angles</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%dihedrals_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">dihedrals_count</code><span class="sig-paren">(</span><em>ndihedrals</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%dihedrals_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of dihedral angles in the topology in <code class="docutils literal"><span class="pre">ndihedrals</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ndihedrals</strong><em> [</em><em>integer</em><em>]</em> :: number of dihedral angles</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%bonds">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">bonds</code><span class="sig-paren">(</span><em>data</em>, <em>nbonds</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%bonds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of bonds in the topology in the pre-allocated array <code class="docutils literal"><span class="pre">data</span></code>
of size <code class="docutils literal"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">nbonds</span></code>.</p>
<p><code class="docutils literal"><span class="pre">data</span></code> size must be passed in the <code class="docutils literal"><span class="pre">nbonds</span></code> parameter, and be equal to
the result of <a class="reference internal" href="#f%chfl_topology%bonds_count" title="f%chfl_topology%bonds_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%bonds_count()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (2, nbonds)<em> [</em><em>integer</em><em>]</em> :: <code class="docutils literal"><span class="pre">2</span> <span class="pre">x</span> <span class="pre">nbonds</span></code> array to be filled with
the bonds in the system</li>
<li><strong>nbonds</strong><em> [</em><em>integer</em><em>]</em> :: size of the array. This should be equal to the
value given by <a class="reference internal" href="#f%chfl_topology%bonds_count" title="f%chfl_topology%bonds_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%bonds_count()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%angles">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">angles</code><span class="sig-paren">(</span><em>data</em>, <em>nangles</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of angles in the <code class="docutils literal"><span class="pre">topology</span></code> in the pre-allocated array
<code class="docutils literal"><span class="pre">data</span></code> of size <code class="docutils literal"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">nangles</span></code>.</p>
<p><code class="docutils literal"><span class="pre">data</span></code> size must be passed in the <code class="docutils literal"><span class="pre">nangles</span></code> parameter, and be equal to the
result of <a class="reference internal" href="#f%chfl_topology%angles_count" title="f%chfl_topology%angles_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%angles_count()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (3, nangles)<em> [</em><em>integer</em><em>]</em> :: <code class="docutils literal"><span class="pre">3</span> <span class="pre">x</span> <span class="pre">nangles</span></code> array to be filled with
the angles in the system</li>
<li><strong>nangles</strong><em> [</em><em>integer</em><em>]</em> :: size of the array. This should be equal to the
value given by <a class="reference internal" href="#f%chfl_topology%angles_count" title="f%chfl_topology%angles_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%angles_count()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%dihedrals">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">dihedrals</code><span class="sig-paren">(</span><em>data</em>, <em>ndihedrals</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%dihedrals" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the list of dihedral angles in the topology in the pre-allocated array
<code class="docutils literal"><span class="pre">data</span></code> of size <code class="docutils literal"><span class="pre">4</span> <span class="pre">x</span> <span class="pre">ndihedrals</span></code>.</p>
<p><code class="docutils literal"><span class="pre">data</span></code> size must be passed in the <code class="docutils literal"><span class="pre">ndihedrals</span></code> parameter, and be equal
to the result of <a class="reference internal" href="#f%chfl_topology%dihedrals_count" title="f%chfl_topology%dihedrals_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%dihedrals_count()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>data</strong> (4, ndihedrals)<em> [</em><em>integer</em><em>]</em> :: <code class="docutils literal"><span class="pre">4</span> <span class="pre">x</span> <span class="pre">ndihedrals</span></code> array to be
filled with the dihedral angles in the system</li>
<li><strong>ndihedrals</strong><em> [</em><em>integer</em><em>]</em> :: size of the array. This should be equal to
the value given by <a class="reference internal" href="#f%chfl_topology%dihedrals_count" title="f%chfl_topology%dihedrals_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_topology%dihedrals_count()</span></code></a>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%add_bond">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">add_bond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%add_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a bond between the atoms at indexes <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> in the topology</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the first atom of the bond</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: atomic index of the second atom of the bond</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%remove_bond">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">remove_bond</code><span class="sig-paren">(</span><em>i</em>, <em>j</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%remove_bond" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove any existing bond between the atoms at indexes <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code> in the
topology.</p>
<p>This function does nothing if there is no bond between <code class="docutils literal"><span class="pre">i</span></code> and <code class="docutils literal"><span class="pre">j</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the first atom</li>
<li><strong>j</strong><em> [</em><em>integer</em><em>]</em> :: The atomic index of the second atom</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%residues_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">residues_count</code><span class="sig-paren">(</span><em>natoms</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%residues_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of residues in the topology in <code class="docutils literal"><span class="pre">nresidues</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>natoms</strong><em> [</em><em>integer</em><em>]</em> :: number of residues</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%add_residue">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">add_residue</code><span class="sig-paren">(</span><em>residue</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%add_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a copy of <code class="docutils literal"><span class="pre">residue</span></code> to this topology.</p>
<p>The residue id must not already be in the topology, and the residue must
contain only atoms that are not already in another residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>residue</strong><em> [</em><a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><em>chfl_residue</em></a><em>]</em> :: residue to add in the topology</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%residues_linked">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">residues_linked</code><span class="sig-paren">(</span><em>first</em>, <em>second</em>, <em>are_linked</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%residues_linked" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the two residues <code class="docutils literal"><span class="pre">first</span></code> and <code class="docutils literal"><span class="pre">second</span></code> from the topology are
linked together, <em>i.e.</em> if there is a bond between one atom in the first
residue and one atom in the second one, and store the result in <code class="docutils literal"><span class="pre">result</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>first</strong><em> [</em><a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><em>chfl_residue</em></a><em>]</em> :: first residue</li>
<li><strong>second</strong><em> [</em><a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><em>chfl_residue</em></a><em>]</em> :: second residue</li>
<li><strong>are_linked</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <code class="docutils literal"><span class="pre">.true.</span></code> if the residues are
linked, <code class="docutils literal"><span class="pre">.false.</span></code> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_topology%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_topology%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_topology%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy a topology, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-residue-type">
<h2><code class="docutils literal"><span class="pre">chfl_residue</span></code> type<a class="headerlink" href="#chfl-residue-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_residue">
<em class="property">type  </em><code class="descname">chfl_residue</code><a class="headerlink" href="#f%_%chfl_residue" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><code class="xref f f-type docutils literal"><span class="pre">chfl_residue</span></code></a> is a group of atoms belonging to the same logical
unit. They can be small molecules, amino-acids in a protein, monomers in
polymers, <em>etc.</em></p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><code class="xref f f-type docutils literal"><span class="pre">chfl_residue</span></code></a> are
<a class="reference internal" href="#f%chfl_residue%init" title="f%chfl_residue%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%init()</span></code></a>, <a class="reference internal" href="#f%chfl_residue%from_topology" title="f%chfl_residue%from_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%from_topology()</span></code></a>,
<a class="reference internal" href="#f%chfl_residue%for_atom" title="f%chfl_residue%for_atom"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%for_atom()</span></code></a> and <a class="reference internal" href="#f%chfl_residue%copy" title="f%chfl_residue%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%copy()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%init" title="f%chfl_residue%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%copy" title="f%chfl_residue%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">from_topology</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%from_topology" title="f%chfl_residue%from_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%from_topology()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">for_atom</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%for_atom" title="f%chfl_residue%for_atom"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%for_atom()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">name</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%name" title="f%chfl_residue%name"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%name()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">id</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%id" title="f%chfl_residue%id"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%id()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">atoms_count</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%atoms_count" title="f%chfl_residue%atoms_count"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%atoms_count()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">add_atom</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%add_atom" title="f%chfl_residue%add_atom"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%add_atom()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">contains</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%contains" title="f%chfl_residue%contains"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%contains()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_residue%free" title="f%chfl_residue%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_residue%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">init</code><span class="sig-paren">(</span><em>name</em><span class="optional">[</span>, <em>id</em>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the residue with a new residue with the given <code class="docutils literal"><span class="pre">name</span></code> and
optional residue identifier <code class="docutils literal"><span class="pre">id</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: residue name</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><ul class="first last simple">
<li><strong>id</strong><em> [</em><em>integer</em><em>]</em> :: residue id</li>
<li><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>residue</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this residue with a copy of <code class="docutils literal"><span class="pre">residue</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>residue</strong><em> [</em><a class="reference internal" href="#f%_%chfl_residue" title="f%_%chfl_residue"><em>chfl_residue</em></a><em>]</em> :: residue to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%from_topology">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">from_topology</code><span class="sig-paren">(</span><em>topology</em>, <em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%from_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this residue with a copy of the residue at index <code class="docutils literal"><span class="pre">i</span></code> from a
<code class="docutils literal"><span class="pre">topology</span></code>. The residue index in the topology is not always the same as
the residue id.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: topology</li>
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: index of the residue in the topology</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%for_atom">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">for_atom</code><span class="sig-paren">(</span><em>topology</em>, <em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%for_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a copy of the residue containing the atom at index <code class="docutils literal"><span class="pre">i</span></code> in the
<code class="docutils literal"><span class="pre">topology</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: topology</li>
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: index of the atom in the topology</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%name">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">name</code><span class="sig-paren">(</span><em>name</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of the residue in the string buffer <code class="docutils literal"><span class="pre">name</span></code>.</p>
<p>The buffer size must be passed in <code class="docutils literal"><span class="pre">buffsize</span></code>. This function will truncate
the residue name to fit in the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=buffsize</em><em>]</em> :: string buffer to be filled with
the residue name</li>
<li><strong>buffsize</strong> :: length of the string buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%id">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">id</code><span class="sig-paren">(</span><em>id</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%id" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the identifier of the residue in the initial topology file in <code class="docutils literal"><span class="pre">id</span></code></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>id</strong><em> [</em><em>integer</em><em>]</em> :: identifier of the residue</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%atoms_count">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">atoms_count</code><span class="sig-paren">(</span><em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%atoms_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of atoms in the residue in <code class="docutils literal"><span class="pre">size</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: number of atoms in the residue</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%add_atom">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">add_atom</code><span class="sig-paren">(</span><em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%add_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>Add the atom at index <code class="docutils literal"><span class="pre">i</span></code> in the residue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: index of the atom to add</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%contains">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">contains</code><span class="sig-paren">(</span><em>i</em>, <em>result</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the atom at index <code class="docutils literal"><span class="pre">i</span></code> is in the residue, and store the result in
<code class="docutils literal"><span class="pre">result</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: index of the atom</li>
<li><strong>result</strong><em> [</em><em>logical</em><em>,</em><em>kind=1</em><em>]</em> :: <cite>.true.</cite> if the atom is in the residue,
<cite>.false.</cite> otherwise</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_residue%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_residue%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_residue%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy a residue, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-atom-type">
<h2><code class="docutils literal"><span class="pre">chfl_atom</span></code> type<a class="headerlink" href="#chfl-atom-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_atom">
<em class="property">type  </em><code class="descname">chfl_atom</code><a class="headerlink" href="#f%_%chfl_atom" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><code class="xref f f-type docutils literal"><span class="pre">chfl_atom</span></code></a> is a particle in the current <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a>. It stores the
following atomic properties:</p>
<ul class="simple">
<li>atom name;</li>
<li>atom type;</li>
<li>atom mass;</li>
<li>atom charge.</li>
</ul>
<p>The atom name is usually an unique identifier (<code class="docutils literal"><span class="pre">H1</span></code>, <code class="docutils literal"><span class="pre">C_a</span></code>) while the
atom type will be shared between all particles of the same type: <code class="docutils literal"><span class="pre">H</span></code>,
<code class="docutils literal"><span class="pre">Ow</span></code>, <code class="docutils literal"><span class="pre">CH3</span></code>.</p>
<p>The initialization routine for <a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><code class="xref f f-type docutils literal"><span class="pre">chfl_atom</span></code></a> are
<a class="reference internal" href="#f%chfl_atom%init" title="f%chfl_atom%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%init()</span></code></a>, <a class="reference internal" href="#f%chfl_atom%from_frame" title="f%chfl_atom%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%from_frame()</span></code></a> and
<a class="reference internal" href="#f%chfl_atom%from_topology" title="f%chfl_atom%from_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%from_topology()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%init" title="f%chfl_atom%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%copy" title="f%chfl_atom%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">from_frame</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%from_frame" title="f%chfl_atom%from_frame"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%from_frame()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">from_topology</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%from_topology" title="f%chfl_atom%from_topology"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%from_topology()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">mass</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%mass" title="f%chfl_atom%mass"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%mass()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_mass</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%set_mass" title="f%chfl_atom%set_mass"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%set_mass()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">charge</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%charge" title="f%chfl_atom%charge"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%charge()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_charge</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%set_charge" title="f%chfl_atom%set_charge"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%set_charge()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">type</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%type" title="f%chfl_atom%type"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%type()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_type</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%set_type" title="f%chfl_atom%set_type"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%set_type()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">name</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%name" title="f%chfl_atom%name"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%name()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">set_name</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%set_name" title="f%chfl_atom%set_name"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%set_name()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">full_name</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%full_name" title="f%chfl_atom%full_name"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%full_name()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">vdw_radius</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%vdw_radius" title="f%chfl_atom%vdw_radius"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%vdw_radius()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">covalent_radius</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%covalent_radius" title="f%chfl_atom%covalent_radius"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%covalent_radius()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">atomic_number</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%atomic_number" title="f%chfl_atom%atomic_number"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%atomic_number()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_atom%free" title="f%chfl_atom%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_atom%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">init</code><span class="sig-paren">(</span><em>name</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this atom with the given <code class="docutils literal"><span class="pre">name</span></code>, and set the atom type to
<code class="docutils literal"><span class="pre">name</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: atom name</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>atom</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this atom with a copy of <code class="docutils literal"><span class="pre">atom</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>atom</strong><em> [</em><a class="reference internal" href="#f%_%chfl_atom" title="f%_%chfl_atom"><em>chfl_atom</em></a><em>]</em> :: atom to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%from_frame">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">from_frame</code><span class="sig-paren">(</span><em>frame</em>, <em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%from_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this atom with a copy the atom at index <code class="docutils literal"><span class="pre">i</span></code> from a <code class="docutils literal"><span class="pre">frame</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame</li>
<li><strong>i</strong><em> [</em><em>integer</em><em>]</em> :: atom index in the frame</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%from_topology">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">from_topology</code><span class="sig-paren">(</span><em>topology</em>, <em>i</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%from_topology" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize this atom with a copy the atom at index <code class="docutils literal"><span class="pre">i</span></code> from a
<code class="docutils literal"><span class="pre">topology</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>topology</strong><em> [</em><a class="reference internal" href="#f%_%chfl_topology" title="f%_%chfl_topology"><em>chfl_topology</em></a><em>]</em> :: topology</li>
<li><strong>idx</strong><em> [</em><em>integer</em><em>]</em> :: atom index in the topology</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%mass">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">mass</code><span class="sig-paren">(</span><em>mass</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the mass of tah atom in <code class="docutils literal"><span class="pre">mass</span></code>. The mass is in atomic mass units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mass</strong><em> [</em><em>real</em><em>]</em> :: atom mass</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%set_mass">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">set_mass</code><span class="sig-paren">(</span><em>mass</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%set_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the mass of the atom to <code class="docutils literal"><span class="pre">mass</span></code>. The mass should be in atomic mass
units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>mass</strong><em> [</em><em>real</em><em>]</em> :: new atom mass</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%charge">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">charge</code><span class="sig-paren">(</span><em>charge</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the charge of the atom in <code class="docutils literal"><span class="pre">charge</span></code>. The charge is in number of the
electron charge <em>e</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>charge</strong><em> [</em><em>real</em><em>]</em> :: The atom charge</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%set_charge">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">set_charge</code><span class="sig-paren">(</span><em>charge</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%set_charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the charge of the atom to <code class="docutils literal"><span class="pre">charge</span></code>. The charge should be in number of
the electron charge <em>e</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>charge</strong><em> [</em><em>real</em><em>]</em> :: new atom charge</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%name">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">name</code><span class="sig-paren">(</span><em>name</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of an atom in the string buffer <code class="docutils literal"><span class="pre">name</span></code>.</p>
<p>The buffer size must be passed in <code class="docutils literal"><span class="pre">buffsize</span></code>. This function will truncate
the name to fit in the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=buffsize</em><em>]</em> :: string buffer to be filled with
the atom name</li>
<li><strong>buffsize</strong> :: length of the string buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%set_name">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">set_name</code><span class="sig-paren">(</span><em>name</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%set_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the name of an atom to <code class="docutils literal"><span class="pre">name</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: new atom name</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%full_name">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">full_name</code><span class="sig-paren">(</span><em>name</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%full_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full name of an <code class="docutils literal"><span class="pre">atom</span></code> from its type in the string buffer
<code class="docutils literal"><span class="pre">name</span></code>.</p>
<p>The buffer size must be passed in <code class="docutils literal"><span class="pre">buffsize</span></code>. This function will truncate
the name to fit in the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=buffsize</em><em>]</em> :: string buffer to be filled with
the atom full name</li>
<li><strong>buffsize</strong> :: length of the string buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%type">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">type</code><span class="sig-paren">(</span><em>type</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the type of an atom in the string buffer <code class="docutils literal"><span class="pre">type</span></code>.</p>
<p>The buffer size must be passed in <code class="docutils literal"><span class="pre">buffsize</span></code>. This function will truncate
the type to fit in the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=buffsize</em><em>]</em> :: string buffer to be filled with
the atom type</li>
<li><strong>buffsize</strong> :: length of the string buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%set_type">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">set_type</code><span class="sig-paren">(</span><em>type</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%set_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the type of an atom to <code class="docutils literal"><span class="pre">type</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>name</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: new atom type</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%vdw_radius">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">vdw_radius</code><span class="sig-paren">(</span><em>radius</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%vdw_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Van der Waals radius of an atom from the atom type in <code class="docutils literal"><span class="pre">radius</span></code>.</p>
<p>If the radius in unknown, this function set <code class="docutils literal"><span class="pre">radius</span></code> to -1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radius</strong><em> [</em><em>real</em><em>]</em> :: Van der Waals radius</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%covalent_radius">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">covalent_radius</code><span class="sig-paren">(</span><em>radius</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%covalent_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the covalent radius of an atom from the atom type in <code class="docutils literal"><span class="pre">radius</span></code>.</p>
<p>If the radius in unknown, this function set <code class="docutils literal"><span class="pre">radius</span></code> to -1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>radius</strong><em> [</em><em>real</em><em>]</em> :: covalent radius</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%atomic_number">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">atomic_number</code><span class="sig-paren">(</span><em>number</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%atomic_number" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the atomic number of an atom from the atom type in <code class="docutils literal"><span class="pre">number</span></code>.</p>
<p>If the atomic number in unknown, this function set <code class="docutils literal"><span class="pre">number</span></code> to -1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>number</strong><em> [</em><em>integer</em><em>]</em> :: atomic number</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_atom%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_atom%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_atom%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy an atom, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="chfl-selection-type">
<h2><code class="docutils literal"><span class="pre">chfl_selection</span></code> type<a class="headerlink" href="#chfl-selection-type" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="f%_%chfl_selection">
<em class="property">type  </em><code class="descname">chfl_selection</code><a class="headerlink" href="#f%_%chfl_selection" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="#f%_%chfl_selection" title="f%_%chfl_selection"><code class="xref f f-type docutils literal"><span class="pre">chfl_selection</span></code></a> allow to select atoms in a <a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><code class="xref f f-type docutils literal"><span class="pre">chfl_frame</span></code></a>,
from a selection language. The selection language is built by combining
basic operations. Each basic operation follows the
<code class="docutils literal"><span class="pre">&lt;selector&gt;[(&lt;variable&gt;)]</span> <span class="pre">&lt;operator&gt;</span> <span class="pre">&lt;value&gt;</span></code> structure, where
<code class="docutils literal"><span class="pre">&lt;operator&gt;</span></code> is a comparison operator in <code class="docutils literal"><span class="pre">==</span> <span class="pre">!=</span> <span class="pre">&lt;</span> <span class="pre">&lt;=</span> <span class="pre">&gt;</span> <span class="pre">&gt;=</span></code>.</p>
<p>The initialization routines for <a class="reference internal" href="#f%_%chfl_selection" title="f%_%chfl_selection"><code class="xref f f-type docutils literal"><span class="pre">chfl_selection</span></code></a> are
<a class="reference internal" href="#f%chfl_selection%init" title="f%chfl_selection%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%init()</span></code></a> and <a class="reference internal" href="#f%chfl_selection%copy" title="f%chfl_selection%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%copy()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">init</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%init" title="f%chfl_selection%init"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%init()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">copy</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%copy" title="f%chfl_selection%copy"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%copy()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">size</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%size" title="f%chfl_selection%size"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%size()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">string</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%string" title="f%chfl_selection%string"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%string()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">evaluate</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%evaluate" title="f%chfl_selection%evaluate"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%evaluate()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">matches</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%matches" title="f%chfl_selection%matches"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%matches()</span></code></a></li>
<li><code class="descname">% </code><code class="descname">free</code><em> [</em><em>subroutine</em><em>]</em> :: <a class="reference internal" href="#f%chfl_selection%free" title="f%chfl_selection%free"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%free()</span></code></a></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%init">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">init</code><span class="sig-paren">(</span><em>selection</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the selection with a new selection from the given <code class="docutils literal"><span class="pre">selection</span></code>
string.</p>
<p>See the <a class="reference external" href="http://chemfiles.org/chemfiles/latest/selections.html">selection documentation</a> for the selection language specification.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>selection</strong><em> [</em><em>character</em><em>,</em><em>len=*</em><em>]</em> :: The selection string</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%copy">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">copy</code><span class="sig-paren">(</span><em>selection</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the selection with a copy of <code class="docutils literal"><span class="pre">selection</span></code>.</p>
<p>The copy does not contains any state, and <a class="reference internal" href="#f%chfl_selection%evaluate" title="f%chfl_selection%evaluate"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%evaluate()</span></code></a>
must be called again before using <a class="reference internal" href="#f%chfl_selection%matches" title="f%chfl_selection%matches"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%matches()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>selection</strong><em> [</em><a class="reference internal" href="#f%_%chfl_selection" title="f%_%chfl_selection"><em>chfl_selection</em></a><em>]</em> :: selection to copy</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%size">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">size</code><span class="sig-paren">(</span><em>size</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the size of the selection in <code class="docutils literal"><span class="pre">size</span></code>.</p>
<p>The size of a selection is the number of atoms we are selecting together.
This value is 1 for the ‘atom’ context, 2 for the ‘pair’ and ‘bond’ context,
3 for the ‘three’ and ‘angles’ contextes and 4 for the ‘four’ and ‘dihedral’
contextes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>size</strong><em> [</em><em>integer</em><em>]</em> :: selection size</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%string">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">string</code><span class="sig-paren">(</span><em>string</em>, <em>buffsize</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%string" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the selection string used to create this selection in the <code class="docutils literal"><span class="pre">string</span></code>
buffer.</p>
<p>The buffer size must be passed in <code class="docutils literal"><span class="pre">buffsize</span></code>. This function will truncate
the selection string to fit in the buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>size</strong><em> [</em><em>character</em><em>,</em><em>len=buffsize</em><em>]</em> :: string buffer to be filled with the
initial selection string</li>
<li><strong>buffsize</strong><em> [</em><em>integer</em><em>]</em> :: size of the string buffer</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%evaluate">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">evaluate</code><span class="sig-paren">(</span><em>frame</em>, <em>nmatches</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the selection for a given <code class="docutils literal"><span class="pre">frame</span></code>, and store the number of
matches in <code class="docutils literal"><span class="pre">nmatches</span></code>. Use <a class="reference internal" href="#f%chfl_selection%matches" title="f%chfl_selection%matches"><code class="xref f f-func docutils literal"><span class="pre">chfl_selection%matches()</span></code></a> to get the
matches.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>frame</strong><em> [</em><a class="reference internal" href="#f%_%chfl_frame" title="f%_%chfl_frame"><em>chfl_frame</em></a><em>]</em> :: frame to evaluate</li>
<li><strong>n_matches</strong><em> [</em><em>integer</em><em>]</em> :: number of matches for this selection</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%matches">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">matches</code><span class="sig-paren">(</span><em>matches</em>, <em>n</em><span class="optional">[</span>, <em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the matches for the <code class="docutils literal"><span class="pre">selection</span></code> after a call to
<code class="xref f f-func docutils literal"><span class="pre">chfl_selection%evalutate()</span></code>, in the pre-allocated <code class="docutils literal"><span class="pre">matches</span></code> array.
The size of the <code class="docutils literal"><span class="pre">matches</span></code> array must be passed in <code class="docutils literal"><span class="pre">n</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matches</strong> (nmatchs)<em> [</em><a class="reference internal" href="#f%_%chfl_match" title="f%_%chfl_match"><em>chfl_match</em></a><em>,</em><em>allocatable</em><em>]</em> :: Pre-allocated array of
the size given by <code class="docutils literal"><span class="pre">chfl_selection%evaluate</span></code>.</li>
<li><strong>n</strong><em> [</em><em>integer</em><em>]</em> :: size of the <code class="docutils literal"><span class="pre">matches</span></code> array</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Options:</th><td class="field-body"><p class="first last"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="subroutine">
<dt id="f%chfl_selection%free">
<em class="property">subroutine  </em><code class="descclassname">chfl_selection%</code><code class="descname">free</code><span class="sig-paren">(</span><span class="optional">[</span><em>status</em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#f%chfl_selection%free" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy a selection, and free the associated memory</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Options:</th><td class="field-body"><strong>status</strong><em> [</em><em>integer</em><em>,</em><em>optional, kind=chfl_status</em><em>]</em> :: status code of the
operation. If it is not equal to <code class="docutils literal"><span class="pre">CHFL_SUCCESS</span></code>, you can learn more
about the error by using <code class="docutils literal"><span class="pre">chfl_last_error</span></code>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="type">
<dt id="f%_%chfl_match">
<em class="property">type  </em><code class="descname">chfl_match</code><a class="headerlink" href="#f%_%chfl_match" title="Permalink to this definition">¶</a></dt>
<dd><p>This type contains the matched atoms for a given selection in the <code class="docutils literal"><span class="pre">atoms</span></code>
array. Values in the <code class="docutils literal"><span class="pre">atoms</span></code> array are valid up to the <code class="docutils literal"><span class="pre">size</span></code> of this
match. If the match size is 2, then <code class="docutils literal"><span class="pre">atom(1)</span></code> and <code class="docutils literal"><span class="pre">atom(2)</span></code> are valid,
and <code class="docutils literal"><span class="pre">atom(3)</span></code> and <code class="docutils literal"><span class="pre">atom(4)</span></code> contains invalid indexes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Type fields:</th><td class="field-body"><ul class="first last simple">
<li><code class="descname">% </code><code class="descname">size</code><em> [</em><em>integer</em><em>]</em> :: The size of this match.</li>
<li><code class="descname">% </code><code class="descname">atoms</code> (4)<em> [</em><em>integer</em><em>]</em> :: The index of the matched atoms.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2015, Guillaume Fraux — MPLv2 licence.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>